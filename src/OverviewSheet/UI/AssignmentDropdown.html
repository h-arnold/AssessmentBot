<!-- UI/AssignmentDropdown.html -->
<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <link rel="stylesheet" href="../ui/assets/material-web.css">
    <style>
      .modal-content {
        padding: 20px;
      }
      .modal-footer {
        text-align: right;
        padding: 10px;
      }
      .modal-footer md-filled-button,
      .modal-footer md-outlined-button {
        margin-left: 10px;
      }
    </style>
  </head>
  <body>
    <div class="modal-content">
      <div class="input-field">
        <md-outlined-select id="assignments" name="assignments" label="Select Assignment">
          <? for (var i = 0; i < assignments.length; i++) { ?>
            <md-select-option value="<?= assignments[i].id ?>" data-name="<?= assignments[i].title ?>">
              <div slot="headline"><?= assignments[i].title ?></div>
            </md-select-option>
          <? } ?>
        </md-outlined-select>
      </div>
    </div>
    <div class="modal-footer">
      <md-outlined-button onclick="google.script.host.close()">Cancel</md-outlined-button>
      <md-filled-button onclick="go()">Go</md-filled-button>
    </div>

    <script src="../ui/assets/material-web.js"></script>
    <script>
      function go() {
        const select = document.getElementById('assignments');
        const assignmentId = select.value;
        const selectedOption = select.querySelector(`md-select-option[value="${assignmentId}"]`);
        const assignmentName = selectedOption ? selectedOption.getAttribute('data-name') : '';

        const assignmentData = JSON.stringify({
          id: assignmentId,
          name: assignmentName
        });

        google.script.run
          .withFailureHandler(function(error) {
            alert('Error: ' + error.message);
          })
          .openReferenceSlideModal(assignmentData);
      }
    </script>
  </body>
</html>
