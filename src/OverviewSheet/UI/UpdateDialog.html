<-- UpdateDialog.html -->

    <!DOCTYPE html>
    <html>

    <head>
        <base target="_top">
        <link rel="stylesheet" href="../ui/assets/material-web.css">
        <style>
            .modal-content {
                padding: 20px;
            }

            .modal-footer {
                text-align: right;
                padding: 10px;
            }

            .modal-footer md-filled-button,
            .modal-footer md-outlined-button {
                margin-left: 10px;
            }
        </style>
    </head>

    <body>
        <div class="modal-content">
            <div class="input-field">
                <md-outlined-select id="versions" name="versions" label="Select Version to Update To">
                    <? for (var version in versions) { ?>
                    <md-select-option value="<?= version ?>"
                        data-assessment-id="<?= versions[version].assessmentRecordTemplateFileId ?>"
                        data-admin-id="<?= versions[version].adminSheetFileId ?>">
                        <div slot="headline">Version <?= version ?></div>
                    </md-select-option>
                    <? } ?>
                </md-outlined-select>
            </div>
        </div>
        <div class="modal-footer">
            <md-outlined-button onclick="google.script.host.close()">Cancel</md-outlined-button>
            <md-filled-button onclick="updateVersion()">Update</md-filled-button>
        </div>

        <script src="../ui/assets/material-web.js"></script>
        <script>
            function updateVersion() {
                const select = document.getElementById('versions');
                const selectedOption = select.querySelector(`md-select-option[value="${select.value}"]`);

                const versionData = {
                    version: select.value,
                    assessmentRecordTemplateFileId: selectedOption.getAttribute('data-assessment-id'),
                    adminSheetFileId: selectedOption.getAttribute('data-admin-id')
                };

                google.script.run
                    .withSuccessHandler(function () {
                        google.script.host.close();
                    })
                    .withFailureHandler(function (error) {
                        alert('Error: ' + error.message);
                    })
                    .handleVersionUpdate(versionData);
            }
        </script>
    </body>

    </html>