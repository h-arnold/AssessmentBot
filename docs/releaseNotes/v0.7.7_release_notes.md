# ‚ö†Ô∏è v0.7.7

This quick patch release contains a single practical fix: the URL validator was erroneously rejecting certain valid slide URLS preventing slides with image tasks from being parsed.

## üö® Breaking change reminder from v0.7.6

- Assignment Definitions moved entirely into JsonDbApp and the ScriptProperties registry was emptied in v0.7.6. If you have not already completed the upgrade steps described there, resolve the state described in [the v0.7.6 release notes](docs/releaseNotes/v0.7.6_release_notes.md) before installing this patch.

## ‚ú® New features & improvements

- Slide parsing now accepts Google Slides export URLs even when the standard `URL` constructor rejects them, so image tasks stop dropping out of the definition pipeline and we log a descriptive warning instead of an error.
- `AssessmentFlow.md` now documents the definition lifecycle and the rationale behind the re-check that happens during trigger execution, clarifying why the pipeline revisits definitions after the UI flow has started.
- OAuth scopes for Classroom access are now the readonly variants in `TriggerController` and the Apps Script manifests, matching the tighter permissions enforced by the hosted script.
- Added a regression test (`tests/utils/isValidUrl.test.js`) that simulates the export URL failure and asserts that the new fallback path keeps validation green while warning via `ABLogger`.

## üóÇ Files changed (high level)

- [src/AdminSheet/Utils/Utils.js](src/AdminSheet/Utils/Utils.js) ‚Äî added trimming, warning logging, and a Slides export whitelist inside `isValidUrl` so we can surface the original error while still accepting the URL.
- [src/AdminSheet/Utils/TriggerController.js](src/AdminSheet/Utils/TriggerController.js) plus both `appsscript.json` manifests ‚Äî switched Classroom scopes to the readonly variants and documented the scope-sync process.
- [docs/developer/AssessmentFlow.md](docs/developer/AssessmentFlow.md) ‚Äî described the definition lifecycle and the rationale for the freshness re-check.
- [tests/utils/isValidUrl.test.js](tests/utils/isValidUrl.test.js) ‚Äî new Vitest suite that verifies export URLs are accepted and demonstrates the warning/logging behaviour.

## ‚¨ÜÔ∏è Updating to v0.7.7

1. Open the Admin Sheet and choose Assessment Bot ‚Üí Settings ‚Üí Update Version.
2. Select v0.7.7 from the dropdown and follow the prompts to reinstall the latest script bundle.
3. No data migration is required beyond the v0.7.6 steps.

## ‚¨áÔ∏è Link to assets & downloads

Latest release assets for v0.7.7: https://drive.google.com/drive/folders/1hkIRo11J74Yn8C7KM73FSG5AhvGNaKxu?usp=sharing

## üßæ Changelog summary (technical)

- Fix: `Utils.isValidUrl` now trims inputs, preserves Slide export URLs, warns with `ABLogger`, and avoids throwing when `URL` parsing fails.
- Docs: clarified when and why definitions are refreshed in `AssessmentFlow`.
- Scope hardening: Classroom scopes became readonly in `TriggerController` and the Apps Script manifests.
- Tests: new coverage for the URL fallback logic plus safer global setup/teardown.
